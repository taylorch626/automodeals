/* global MYACCOUNT_URL */
/**
 * THIS IS A TEMPORARY SCRIPT TO CHANGE LINKS TO THE NEW SAVED SEARCHES PAGE BASED ON A LOCALSTORAGE FLAG
 * !!!! IMPORTANT:
 *    WHEN REMOVING THIS CODE BE SURE TO CHANGE THE LINKS IN
 *        INDEXCONTROLLER.PHP 'getMiniNavLinks' FUNCTION
 *        AND
 *        SEARCH.JS '_getLinks' FUNCTION
 *    TO BE: MYACCOUNT_URL + "/saved-searches-car"
 *    THEN
 *        UNCOMMENT THE REDIRECT IN FAVORITECONTROLLER.PHP 'indexAction'
 * */
window.onload = function() {
  var flag;
  if (typeof Storage === "undefined") {
    flag = false;
  } else {
    handleURLFlag();
    flag = localStorage.getItem("flag");
  }

  var links = document.querySelectorAll('[href^="/favorite"]');
  for (var i = 0; i < links.length; i++) {
    links[i].href = window.MYACCOUNT_URL + "/saved-searches-car";
  }
};

/**
 * Checks the url for 'flag=true' and sets localStorage
 */
function handleURLFlag() {
  if (window.location.href.indexOf("flag=true") > -1) {
    localStorage.setItem("flag", true);
  }
}
