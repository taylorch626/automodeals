$(function() {
    /**
     * Default ads rendered on page load
     */
    adsRendered = {};
    adsRendered.rightRail = false;
    adsRendered.topLeaderboardAd = false;
    adsRendered.bottomPinned320Ad = false;
    adsRendered.bottom320Ad = false;
    adsRendered.bottomPinned768Ad = false;
    adsRendered.bottom768Ad = false;

    /**
     * bool determining whether the reseources are all rendered
     */
    resourcesRendered = false;

    /**
     * Rules for defining which ad blocks are displayed on which breakpoints
     */
    Reusables.Breakpoints.on($(window))
        .define([0, 768], {
            enter: function() {
                // Top block
                $(".top_ad_leaderboard").hide(0);
                // Right rail block
                $(".rightrail_ad_block").hide(0);
                // Bottom block
                $(".bottom_ad_block").show(0);
                $(".bottom_320_block").show(0);
                $(".bottom_768_block").hide(0);
                // Bottom pined block
                $(".fixed_footer_ad_block").show(0);
                $(".fixed_footer_320_block").show(0);
                $(".fixed_footer_768_block").hide(0);

                $(".site-footer").css("marginBottom", "50px");

                // Bottom
                if (adsRendered.bottom320Ad == false) {
                    adsRendered.bottom320Ad = true;
                    $(".bottom320Ad").each(function() {
                        var slotname = $(this).data("slotname");
                        googletag.cmd.push(function() {
                            googletag.display(slotname);
                        });
                    });
                }
                // Bottom pinned
                if (adsRendered.bottomPinned320Ad == false) {
                    adsRendered.bottomPinned320Ad = true;
                    $(".fixedFooter320Ad").each(function() {
                        var slotname = $(this).data("slotname");
                        googletag.cmd.push(function() {
                            googletag.display(slotname);
                        });
                    });
                }

                // Resource Widgets
                if (resourcesRendered == false) {
                    resourcesRendered = true;
                    $(".vdp-contact-info.resource").each(function() {
                        var slotname = $(this).data("slotname");
                        googletag.cmd.push(function() {
                            googletag.display(slotname);
                        });
                    });
                }
            }
        })
        .define([ 768, 1024 ], {
            enter : function() {
                // Top block
                $(".top_ad_leaderboard").hide(0);
                // Right rail block
                $(".rightrail_ad_block").hide(0);
                // Bottom block
                $(".bottom_ad_block").show(0);
                $(".bottom_320_block").hide(0);
                $(".bottom_768_block").show(0);
                // Bottom pined block
                $(".fixed_footer_ad_block").show(0);
                $(".fixed_footer_320_block").hide(0);
                $(".fixed_footer_768_block").show(0);
                $(".site-footer").css("marginBottom", "90px");

                // Bottom
                if (adsRendered.bottom768Ad == false) {
                    adsRendered.bottom768Ad = true;
                    $(".bottom768Ad").each(function() {
                        var slotname = $(this).data("slotname");
                        googletag.cmd.push(function() {
                            googletag.display(slotname);
                        });
                    });
                }
                // Bottom pinned
                if (adsRendered.bottomPinned768Ad == false) {
                    adsRendered.bottomPinned768Ad = true;
                    $(".fixedFooter768Ad").each(function() {
                        var slotname = $(this).data("slotname");
                        googletag.cmd.push(function() {
                            googletag.display(slotname);
                        });
                    });
                }

                // Resource Widgets
                if (resourcesRendered == false) {
                    resourcesRendered = true;
                    $(".vdp-contact-info.resource").each(function() {
                        var slotname = $(this).data("slotname");
                        googletag.cmd.push(function() {
                            googletag.display(slotname);
                        });
                    });
                }
            }
        })
        .define([ 1024, Infinity ], {
            enter : function() {
                // Top block
                $(".top_ad_leaderboard").show(0);
                // Right rail block
                $(".rightrail_ad_block").show(0);
                // Bottom block
                $(".bottom_ad_block").hide(0);
                $(".bottom_320_block").hide(0);
                $(".bottom_768_block").hide(0);
                // Bottom pined block
                $(".fixed_footer_ad_block").hide(0);
                $(".fixed_footer_320_block").hide(0);
                $(".fixed_footer_768_block").hide(0);
                $(".site-footer").css("marginBottom", "0");
                // Right rail ads
                if (adsRendered.rightRail == false) {
                    adsRendered.rightRail = true;
                    $(".rightRailAd").each(function() {
                        var slotname = $(this).data("slotname");
                        googletag.cmd.push(function() {
                            googletag.display(slotname);
                        });
                    });
                }
                // Top large leaderboard
                if (adsRendered.topLeaderboardAd == false) {
                    adsRendered.topLeaderboardAd = true;
                    $(".topAd.leaderboardAd").each(function() {
                        var slotname = $(this).data("slotname");
                        googletag.cmd.push(function() {
                            googletag.display(slotname);
                        });
                    });
                }

                // Resource Widgets
                if (resourcesRendered == false) {
                    resourcesRendered = true;
                    $(".vdp-contact-info.resource").each(function() {
                        var slotname = $(this).data("slotname");
                        googletag.cmd.push(function() {
                            googletag.display(slotname);
                        });
                    });
                }
            }
        });

    /**
     * trigger the loaded screen width 
     */
    Reusables.Breakpoints.evaluate();
});
